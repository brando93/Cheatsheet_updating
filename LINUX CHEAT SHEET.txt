*****************
*               *
*               *
*   Commands    *
*               *
*               *
*****************

sudo grep -i brandon /home/ibmadmin/.ssh/authorized_keys

stat: check whether file has been accessed or modified
pwd: To know where we is the position in the server.
cd: to move to a different locations or directories on the server.
cp: to copy a file or directory.
ls: display list of items on a directory.
ls -ald: display the list of items on a directory with the attributes.
mkdir: to create new directories.
touch: to create new files.
mv: to cut or rename a directory or file.
rm: to delete directories or files.
rmdir: to delete empty directories.
uname: displays the OS version and the hostname.
hostname:  to get server’s hostname.
chmod: to change the permission of a directory or a file.
chown: to change owner:group of a directory, or  file.
chgrp: to change the group to a file or directory.  <group> <file or directory>.
groupadd: create a new group.
flags
-g: specify the group id
-r: system group (any user that has this group will have access to system files).
cat: to view information within a file.
df: to check file system’s information, like total size, free size, mount point etc.
du: to check information of a path.
free: to view memory information
whereis/locate/find: to view the path of a command.
who/w: the userids that connected to the server
whoami: shows the user id that is currently logedin
last: display the information of the last restart of the system
dd: is a low - level fi le copying tool, with the ability to apply certain
transformations at the same time. As a backup tool, dd is useful for backing up an entire
raw fi lesystem
dd if=/dev/sda3 of=/dev/st0
Permite copiar y convertir datos de archivos a bajo nivel.
Es generalmente usado para realizar operaciones avanzadas sobre dispositivos o archivos, como pueden ser:
Transferencias de datos específicos.
Copias de seguridad de la información «en crudo» (raw data).
Conversión de algunas codificaciones soportadas y/o caracteres predefinido
pstree: see tree of processes
write/talk: lets you send a message to another linux machine
wall: send a global message to all users logged in
date: displays current date and time.
uptime: displays the time that the server has running since last start.
echo: to indicate to the system that the information is just text and to insert it on a file using  >>
lscfg: Displays configuration, diagnostic, and vital product data (VPD) information about the system. Vital Product Data (VPD) is a collection of configuration and informational data associated with a set of hardware or software.
cat /proc/version: Reports the latest installed maintenance level of the system
iprconfig: Provides a menu allowing for managing RAID arrays
env: shows all environment variables
nice: provides mayor or minor resources/priorities to processes
renice: alter its priority without disrupting the programs operations
nohup: Running Programs Persistently
chattr: Make files or directories immutable or not removable.
	chattr +i: make file unremovable
cut -d, -f 3: used to cut text, -d means of delimitator and -f means field.
sed: used to exchange words, numbers, signs in text. E.g.: sed 's/2009/2010/' cal-122923.txt > cal223.txt
lsattr: list file’s attributes for command chattr.
wc: count lines in text file
cpio: is used to backup files mostly. cpio needs to get a list of files in order to copy. E.g.: fin ./boot /home/brodriguez/file_backedup.cpio
pr: used to print plain text of a file. E.g.: pr myfile.txt
zcat: see content in files .tar without extracting

ldconfig: Rebuilding the Library Cache. Creates the necessary links and cache to the most recent shared libraries found in the directories specified on the command line, in the file  /etc/ld.so.conf, and  in  the trusted directories, /lib and /usr/lib.
lsmod: displays information only about kernel modules
ldd: prints shared object dependencies and libraries
hdparm: tuning your hard disk or DVD drive, but it can also measure read speed, deliver valuable information about the device
Make a file Immutable: chattr +i <filename>
Remove a file Immutability: chattr -i <filename>
rsh: connects to the specified host, and executes the specified command. rsh copies its standard input to the remote command
blkid: displays disks UUID
mount: mount all possible file systems in fstab
locate specific file: sudo locate / --wholename Scripts*
find specific file: sudo find / -type d -name Scripts*
lsb_release: shows good information aobut the systems
hostnamectl status: display bunch info hostname
hostnamectl set-hostname <name of hostname desired>


____________________________________________________________________________________________________

CHANGING TIMEZONE/DATE/TIME


***Changing Current Time:

To change the current time, type the following at a shell prompt as root:

timedatectl set-time HH:MM:SS

***Changing the Current Date
To change the current date, type the following at a shell prompt as root:

timedatectl set-time YYYY-MM-DD

***Changing the Time Zone
To list all available time zones, type the following at a shell prompt:

timedatectl list-timezones

To change the currently used time zone, type as root:

timedatectl set-timezone time_zone


***Changing the Time Zone
To identify which time zone is closest to your present location, use the timedatectl command with the list-timezones command line option. For example, to list all available time zones in Europe, type:

~]# timedatectl list-timezones | grep Europe
Europe/Amsterdam
Europe/Andorra
Europe/Athens
Europe/Belgrade
Europe/Berlin
Europe/Bratislava
…

To change the time zone to Europe/Prague, type as root:

~]# timedatectl set-timezone Europe/Prague



$$$$$$$$$$$$$OTHER WAY TO CHANGE TIMEZONE$$$$$$$$$$$$$$$$

# ls -l /etc/localtime
# date
# rm -rm /etc/localtime
# Create a symbolic link from your chosen time zone file to the /etc/lcoaltime. For instance, you can type <ln -s /usr/share/zoneinfo/US/Easter localtime> to set up the time in the US Easter time.

















______________________________________________________________________________________________________


Ways to copy remote files
rsync
ftp
scp
User Administration
useradd: to create a new user with the following flags.
-G: groups the user needs to have.
-g: Main group the user needs to have.
-c: finger (personal information of the user).
-d: to specify the home.
-p: to specify the password.
-U: specify the umask.
-u: specify the user id for the new user.
passwd: to change password of the user.
userdel: to delete a user.
usermod: to change the user acco

flags
-c: finger.
-d: Replace the home directory.
-e: expire date.
-G: specify the groups the user needs to have.<<
-g: specify the main group.
-u: change user id.
-L: Lock user.
mkpasswd: generate random passwords
lsof: displays all the files that your system has currently opened


Redirecting:


> creates a new file and may overwrite

>> append new lie. If file doesn't exits i creates it

2> creates a new file containing standard error. If the specified file exists it's overwritten

&> creates a new file containing both standard and error ouput. If the specifies file exists it's overwriteen



#############
#           #
#   LVM     #
#           #
#############

Create a File system from cero on new partitions
In case I cannot see the disk I need to scan the buses to see the new disk.
ls /sys/class/scsi_host/
Once I have the hosts
I can use the following command
echo "- - -" > /sys/class/scsi_host/host0/scan
echo "- - -" > /sys/class/scsi_host/host1/scan
echo "- - -" > /sys/class/scsi_host/host2/scan
1) Check if there is space:
lsblk
2) Check partitions.
fdisk -l
3) Create one or more partitions using fdisk:
fdisk <device> ej: /dev/sdb
    n (new partition)
    p (primary partition)
    Accept default initial and end blocks if you want to create a single partition with the whole disk
    w (write the information and quit)
4) Create a physical volume (pv)
pvcreate  /dev/sdb1
  **After this we check the PV with pvs
For Example
pvs /dev/sdc1
PV         VG                 Fmt  Attr PSize   PFree
/dev/sdb   lwqappvg  lvm2 a--  128.00g  46.00g
If the PV needs to be removed use:
pvremove <pv name>  ej: pvremove /dev/sdb1
5) Create the VG, is not created yet.
To check use the vgs comand
Ej; vgs sapvg
To create it:
vgcreate <name of the vg>  <pv1> <pv2>
vgcreate sapvg /dev/sdb1 /dev/sdc1
if we need to extend an existing VG we can use
vgextend <vgname> <pv or pvs that will be added>
vgextend sapvg /dev/sde1
If the VG needs to be reduced
vgreduce <pv>	ej: vgreduce sapvg4 /dev/sdb3
If the VG needs to be removed
vgremove <vg> ej:  vgremove vg4

6) Create the LV
lvcreate -n <name of the LV> -L <size of the LV> <vg>
Ej: lvcreate -n lv1 -L 512M sapvg
To consult a LV we use:
lvs </dev/vg/lvname>
Ej: lvs /dev/vg4/lv4
lvscan to check that is active
ej: lvscan | grep /dev/vg4/lv4
If it is not active use the following
lvchange -a y <lvname>
ej: lvchange -a y /dev/vg4/lv4
If the LV size needs to be increased:
lvextend -L <new size> </dev/mapper/<vg-lv> ej:  lvextend -L +1GB /dev/mapper/sapvg-lv4
If the LV needs to be removed
lvremove </dev/<vg>/<lv>> ej: lvremove /dev/sapvg/lv4

7) Create the Filesystem
mkfs -t <tipo de filesystem> /dev/vgname/lv name
ej: mkfs -t ext4 /dev/sapvg/lv4
If the filesystem needs to be re-sized we can use:
resize2fs <lv>    ej: resize2fs      /dev/sapvg/lv4
8) After you create the file system, please create the directory that will be used as a mount point.

# resize2fs /mount/device node

The resize2fs command can also decrease the size of an unmounted ext4 file system:

# resize2fs /dev/device size


mkdir -p <name of the directory>
mkdir -p /usr/sap/
9) Mount the the file system:
mount </dev/vg/lv> <mountpoint>
Ej:   mount /dev/sapvg/lv4 /usr/sap
Check the filesystem with df -h <mount point>
Ej: df -h /usr/sap
Ej of output
Filesystem           Size   Used Avail Use% Mounted on
/dev/mapper/sapvg-lv4  988M  1.3M  925M   1% /usr/sap
10) enter the information (stanza) on vi /etc/fstab
Ej:     /dev/mapper/sapvg-lv4     /usr/sap           ext4    defaults        0 0

Creating and Manipulating Volume Groups
individual commands ’ man pages for details on their operation.

Command Explanation
vgcfgbackup Backs up volume group metadata, by default to files in /etc/lvm/backup .
vgcfgrestore Restores volume group metadata, by default from files in /etc/lvm/backup .
vgchange Changes certain volume group attributes. Most importantly, it may be used to manually activate or deactivate a volume group.
vgck Checks volume group metadata; similar to fsck for filesystems.
vgconvert Converts volume group metadata from one version to another. LVM
version 2 (LVM2) is the current version in 2011 and has been for some time.
vgcreate Creates a volume group, starting with one or more physical volumes you specify.
vgdisplay Displays information on your volume groups, including information on
the number of physical devices and logical volumes as well as the total and free space.
vgexport Makes a volume group unknown to the system, enabling it to be moved
to another computer for integration into its LVM configuration.
vgextend Adds physical volumes to an existing volume group.
vgimport Makes a volume group known to the system.
vgimportclone Imports a volume group, renaming conflicting logical volumes. This may be used if you ’ve cloned a volume group for backup purposes and find you need to access the backup.
vgmerge Merges two volume groups, one of which must be inactive.
vgmknodes Updates the device files in /dev that refer to logical volumes. Normally not called manually.
vgreduce Removes one or more unused physical volumes from a volume group.
vgremove Completely removes a volume group from the computer; effectively the opposite of vgcreate .
vgrename Renames a volume group.
vgs Displays summary information about a volume group; similar to
vgdisplay but with more terse output.
vgscan Scans the system for volume groups. Normally unneeded but may be helpful after hot - swapping a new disk.
vgsplit Splits a volume group into two; effectively the opposite of vgmerge .


Tuning Filesystems
dumpe2fs, tune2fs, and debugfs. E.j.: dumpe2fs [options] device
Check file system information:
xfs_info
Check filesystem integrity:
fsck [-sACVRTNP] [-t fstype] [--] [fsck-options] filesystems

Warning: Run fsck only on filesystems that are not currently mounted or that are
mounted in read-only mode. Changes written to disk during normal read/
write operations can confuse fsck and result in filesystem corruption.

NFS
This steps are done on the source
1) Check that the /etc/hosts file has the target server information.
2) Check if the NFS service is running
service nfs status
If they are not running, we need to inicialize a service and a deamon
service rpcbind start
service nfs start
If I need to active the firewall
firewall-cmd --zone=public --add-port=2049/tcp --permanent
firewall-cmd –reload

systemctl enable nfs-server


3) Add the filesystem that we would like to export to the /etc/exports (using vi)
Stanza
Filesystem host(options)
/newfilesys4 da1(no_root_squash,rw,sync)
4) Run the command exportfs -ra to re-export the nfs.

These steps are done on the target server
5) Check that the /etc/hosts file has the source server information.
6) Check if the NFS service is running
service nfs status
7) Run service rpcbind start in case is not running.
8) Make the directory for mount point.
9) Use showmount -e <hostsource> to view the files the source is sharing.
10) Mount the filesystem using the following command:
mount <source:filesystem> <target mount point>
ej: mount  redhat1:/newfilesys4 /newfilesys4
11)  Enter the stanza on /etc/fstab with vi
Ej: redhat1:/newfilesys4   /newfilesys4           nfs    defaults        1 2


Networking

####################################################

Maes para recordarles lo siguiente
$ ifconfig -a
en0: flags=1e084863,14c0<UP,BROADCAST,NOTRAILERS,RUNNING,SIMPLEX,MULTICAST,GROUPRT,64BIT,CHECKSUM_OFFLOAD(ACTIVE),LARGESEND,CHAIN>
      inet 172.19.210.28 netmask 0xffffff00 broadcast 172.19.210.255
en1: flags=1e084863,14c0<UP,BROADCAST,NOTRAILERS,RUNNING,SIMPLEX,MULTICAST,GROUPRT,64BIT,CHECKSUM_OFFLOAD(ACTIVE),LARGESEND,CHAIN>
      inet 172.19.83.28 netmask 0xffffff00 broadcast 172.19.83.255
en2: flags=1e084863,14c0<UP,BROADCAST,NOTRAILERS,RUNNING,SIMPLEX,MULTICAST,GROUPRT,64BIT,CHECKSUM_OFFLOAD(ACTIVE),LARGESEND,CHAIN>
      inet 172.23.13.28 netmask 0xffffff00 broadcast 172.23.13.255

en0= IBR o backup
en1= Management
en2= Customer

####################################################


ping <hostname> or ip
traceroute: to check hops to each destination
nslookup <ipaddr or hostname> asks the DNS server for the ip or hostname
netstat: show routing table (list of known hosts) information or connections
ss -ta: simialr to netstat
-at: list tcp ports
-a: list network ports
lsof -i: used to check which ports are listening
sudo lsof -i -P -n | grep LISTEN: check all ports in use


nmcli con show: what it does shows all internet connnections pc has ever has connection with 
nmcli dev status: list all devices
nmcli con up <ID>
nmcli con dow <ID>
nmcli dev dis <DEV>: brings down a interface and disable autoconnect
nmcli net off:disable all managed interfaces
nmcli con add: add new connection
nmcli con del <ID>: delete a connection	



ifconfig:  to show ip address and the mac address (Nic’s)
ifup <ethernet interface>: command to know whether the interface is already configured and up
ip addr show: display the ip address
dig: is a tool for querying DNS nameservers for information
host: performing DNS lookups
wall: sends a message to everybody logged in
nmcli d: shows network cards and its states
whois: You can look up information on a domain as a whole with this command.
tcpdump: is a program that can intercept network packets and log them or display them on the screen.
lspci: list all PCI cards
modprobe: load your network hardware driver.
ifconfig eth0 up: enable interface

ifconfig eth0 down: disable interface
ifconfig eth0 192.168.1.12: Assign IP Address to an Interface
cat /sys/class/net/eth0/operstate: check NIC status

g eth0 netmask 255.255.255. : Change Subnet Mask of Interface eth0

cat /proc/net/dev: list active network devices

How to configure network configuration file:
## Configure eth0
#
# vi /etc/sysconfig/network-scripts/ifcfg-eth0

DEVICE="eth0"
NM_CONTROLLED="yes"
ONBOOT=yes
HWADDR=A4:BA:DB:37:F1:04
TYPE=Ethernet
BOOTPROTO=static
NAME="System eth0"
UUID=5fb06bd0-0bb0-7ffb-45f1-d6edd65f3e03
IPADDR=192.168.1.44
NETMASK=255.255.255.0

##############################################################################


			PROVIDE SUDO ACCESS TO ANY



[root@lcmsqsag001 ~]# ls -lha /etc/sudoers.d/50_sudoers_ops
-r--r----- 1 root root 1.1K Nov 29 16:21 /etc/sudoers.d/50_sudoers_ops
[root@lcmsqsag001 ~]# cat /etc/sudoers.d/50_sudoers_ops
# $HeadURL: file:///gsa/pokgsa/projects/g/gtscloud/sceplus/svn_repos/sup/UNIX/etc/sudo/sudoers.ops $
# $Author: jchalfan $
# $Revision: 107 $
# See the sudoers man page for the details on how to write a sudoers file.
#
# This file is read with the 'include' statement in the base sudoers file.
# This sudoers file is to be used for customer requested sudo commands.
# It should be group based, but individual id's will be permitted in this file
# Cmnd_Aliases created in the base sudoers file CAN NOT be duplicated here.
#
msp5511 ALL=(root) NOPASSWD:ALL,!IBM_NONE_SA,NOEXEC:IBM_SHELLESCAPE_ALL,!IBM_SHELLS_ALL,!REBOOT,!STOP,EXEC:PASSWD,PWDADM,!VSUDO,!CHROOT,!CHRTSEC,/usr/bin/su - *,/bin/su - *
msp5094 ALL=(root) NOPASSWD:ALL,!IBM_NONE_SA,NOEXEC:IBM_SHELLESCAPE_ALL,!IBM_SHELLS_ALL,!REBOOT,!STOP,EXEC:PASSWD,PWDADM,!VSUDO,!CHROOT,!CHRTSEC,/usr/bin/su - *,/bin/su - *
msp5588 ALL=(root) NOPASSWD:ALL,!IBM_NONE_SA,NOEXEC:IBM_SHELLESCAPE_ALL,!IBM_SHELLS_ALL,!REBOOT,!STOP,EXEC:PASSWD,PWDADM,!VSUDO,!CHROOT,!CHRTSEC,/usr/bin/su - *,/bin/su - *




####################################################################################

Set ssh service in debug mode

How to configure SSH to debug mode? https://access.redhat.com/solutions/295863/ Please use the following instructions from the Resolution section in the above link:

1. Open the `/etc/ssh/sshd_config` file in a text editor # vim /etc/ssh/sshd_config 
2. Add the following line and save the file LogLevel DEBUG3 
3. Restart SSHD # service sshd restart "





###############################################################################


Check traffic network throught NIC's

watch -n 1 -d ifconfig <NAME NETWORK INTERFACE>

gather a packet capture on both the source and destination systems: 

tcpdump -s 114 -i <interface> -w /path/to/file.pcap 



###############################################################################

		ADD SECONDARY IP ADDRESS INTO SAME RANGE

###############################################################################

You will need to be the root user and navigate to your /etc/sysconfig/network-scripts

# cd /etc/sysconfig/network-scripts

When getting a list of files in the directory you will see "ifcfg-eth0" (or eth1 if you're doing it for a different adapter)

# ls -l | grep ifcfg-eth
-rw-r--r-- 1 root root   119 Jan 11 19:16 ifcfg-eth0
-rw-r--r-- 1 root root   119 Jan  3 08:45 ifcfg-eth0.bak
-rw-r--r-- 1 root root   119 Feb 24 04:34 ifcfg-eth1
-rw-r--r-- 1 root root   128 Jan 19 18:20 ifcfg-eth1.bak

Now adding the virtual adapters is easy. Basically if the main adapter is called "eth0" you have to call the next (virtual) adapter in a sequential order like so:

    ifcfg-eth0 (primary adapter, physical)
    ifcfg-eth0:1 (first virtual adapter to the physical primary adapter)
    ifcfg-eth0:2 (second virtual adapter to the physical primary adapter)
    and so on...

That being said, lets go ahead and copy our primary adapter configuration file and name it to be the first virtual adapter for the physical primary:

# cp ifcfg-eth0 ifcfg-eth0:1
# ls -l | grep ifcfg-eth
-rw-r--r-- 1 root root   119 Jan 11 19:16 ifcfg-eth0
-rw-r--r-- 1 root root   119 Feb 24 08:53 ifcfg-eth0:1
-rw-r--r-- 1 root root   119 Jan  3 08:45 ifcfg-eth0.bak
-rw-r--r-- 1 root root   119 Feb 24 04:34 ifcfg-eth1
-rw-r--r-- 1 root root   128 Jan 19 18:20 ifcfg-eth1.bak

Now, we have to configure this virtual adapter to be: a static IP (of course), no hardware address (MAC), configure netmask and of course rename the device.

# vim ifcfg-eth0:1
DEVICE=eth0:1
BOOTPROTO=static
ONBOOT=yes
IPADDR=10.1.1.2
NETMASK=255.255.255.0

There is no need to specify a MAC address as it is a virtual adapter and there is also no need to specify a default gateway as it is already routed through the primary adapter. Basically there are only four things that you will need to change:

    File name for the adapter itself
    DEVICE=<device name> (should correspond with the file name)
    IPADDR=<ip address>
    NETMASK=<netmask>

Afterwards, just restart the networking service:

# service network restart

That's it; lets check ifconfig to make sure the virtual adapter is there and working:

# ifconfig eth0:1
eth0:1    Link encap:Ethernet  HWaddr 08:00:27:ED:05:B7
inet addr:10.1.1.2  Bcast:10.1.1.255  Mask:255.255.255.0
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1

# ping 10.1.1.2
PING 10.1.1.2 (10.1.1.2) 56(84) bytes of data.
64 bytes from 10.1.1.2: icmp_seq=1 ttl=64 time=0.073 ms
64 bytes from 10.1.1.2: icmp_seq=2 ttl=64 time=0.042 ms
64 bytes from 10.1.1.2: icmp_seq=3 ttl=64 time=0.029 ms
64 bytes from 10.1.1.2: icmp_seq=4 ttl=64 time=0.029 ms
--- 10.1.1.2 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 2999ms
rtt min/avg/max/mdev = 0.029/0.043/0.073/0.018 ms

Per Steven's comment: a second note. If you're not sure if you've done it right and you do not want to restart the entire network server, you can use the following:

# ifup eth0:1
_______________________________________________________________________________________________________

# ip route: command is used to see the routing table
 
[root@vtempddb01 ~]# ip route
146.89.171.192/28 via 10.177.76.1 dev eth0 
146.89.131.0/26 via 10.177.76.1 dev eth0 
146.89.131.64/26 via 10.177.76.1 dev eth0 
146.89.141.128/25 via 10.177.154.1 dev eth1 
192.168.117.0/24 dev eth2  proto kernel  scope link  src 192.168.117.26 
146.89.140.0/24 via 10.177.76.1 dev eth0 
10.177.154.0/24 dev eth1  proto kernel  scope link  src 10.177.154.26 
10.177.76.0/24 dev eth0  proto kernel  scope link  src 10.177.76.26 
169.254.0.0/16 dev eth0  scope link  metric 1002 
169.254.0.0/16 dev eth1  scope link  metric 1003 
169.254.0.0/16 dev eth2  scope link  metric 1004 
default via 192.168.117.1 dev eth2 

_____________________________________________________________________________________________________

# watch ifconfig eth0: check if traffic is going through right NIC:





#########################################################################

		SECOND WAY TO EXPLAIN IT

#########################################################################

Creating Virtual Interface and Assign Multiple IP Addresses

Here I have an interface called “ifcfg-eth0“, the default interface for the Ethernet device. If you’ve attached second Ethernet device, then there would be an “ifcfg-eth1” device and so on for each device you’ve attached. These device network files are located in “/etc/sysconfig/network-scripts/” directory. Navigate to the directory and do “ls -l” to list all devices.

# cd /etc/sysconfig/network-scripts/
# ls -l

Sample Output

ifcfg-eth0   ifdown-isdn    ifup-aliases  ifup-plusb     init.ipv6-global
ifcfg-lo     ifdown-post    ifup-bnep     ifup-post      net.hotplug
ifdown       ifdown-ppp     ifup-eth      ifup-ppp       network-functions
ifdown-bnep  ifdown-routes  ifup-ippp     ifup-routes    network-functions-ipv6
ifdown-eth   ifdown-sit     ifup-ipv6     ifup-sit
ifdown-ippp  ifdown-tunnel  ifup-isdn     ifup-tunnel
ifdown-ipv6  ifup           ifup-plip     ifup-wireless

Let’s assume that we want to create three additional virtual interfaces to bind three IP addresses (172.16.16.126, 172.16.16.127, and 172.16.16.128) to the NIC. So, we need to create three additional alias files, while “ifcfg-eth0” keeps the same primary IP address. This is how we moving forward to setup three aliases to bind the following IP addresses.

Adapter            IP Address                Type
-------------------------------------------------
eth0              172.16.16.125            Primary
eth0:0            172.16.16.126            Alias 1
eth0:1            172.16.16.127            Alias 2
eth0:2            172.16.16.128            Alias 3

Where “:X” is the device (interface) number to create the aliases for interface eth0. For each alias you must assign a number sequentially. For example, we copying existing parameters of interface “ifcfg-eth0” in virtual interfaces called ifcfg-eth0:0, ifcfg-eth0:1 and ifcfg-eth0:2. Go into the network directory and create the files as shown below.

# cd /etc/sysconfig/network-scripts/
# cp ifcfg-eth0 ifcfg-eth0:0
# cp ifcfg-eth0 ifcfg-eth0:1
# cp ifcfg-eth0 ifcfg-eth0:2

Open a file “ifcfg-eth0” and view the contents.

[root@tecmint network-scripts]# vi ifcfg-eth0
DEVICE="eth0"
BOOTPROTO=static
ONBOOT=yes
TYPE="Ethernet"
IPADDR=172.16.16.125
NETMASK=255.255.255.224
GATEWAY=172.16.16.100
HWADDR=00:0C:29:28:FD:4C

Here we only need two parameters (DEVICE and IPADDR). So, open each file with VI editor and rename the DEVICE name to its corresponding alias and change the IPADDR address. For example, open files “ifcfg-eth0:0“, “ifcfg-eth0:1” and “ifcfg-eth0:2” using VI editor and change both the parameters. Finally it will look similar to below.
ifcfg-eth0:0

DEVICE="eth0:0"
BOOTPROTO=static
ONBOOT=yes
TYPE="Ethernet"
IPADDR=172.16.16.126
NETMASK=255.255.255.224
GATEWAY=172.16.16.100
HWADDR=00:0C:29:28:FD:4C

ifcfg-eth0:1

DEVICE="eth0:1"
BOOTPROTO=static
ONBOOT=yes
TYPE="Ethernet"
IPADDR=172.16.16.127
NETMASK=255.255.255.224
GATEWAY=172.16.16.100
HWADDR=00:0C:29:28:FD:4C

ifcfg-eth0:2

DEVICE="eth0:2"
BOOTPROTO=static
ONBOOT=yes
TYPE="Ethernet"
IPADDR=172.16.16.128
NETMASK=255.255.255.224
GATEWAY=172.16.16.100
HWADDR=00:0C:29:28:FD:4C

Once, you’ve made all changes, save all your changes and restart/start the network service for the changes to reflect.

[root@tecmint network-scripts]# /etc/init.d/network restart

To verify all the aliases (virtual interface) are up and running, you can use “ifconfig” or “ip” command.

[root@tecmint network-scripts]# ifconfig
eth0      Link encap:Ethernet  HWaddr 00:0C:29:28:FD:4C
inet addr:172.16.16.125  Bcast:172.16.16.100  Mask:255.255.255.224
inet6 addr: fe80::20c:29ff:fe28:fd4c/64 Scope:Link
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
RX packets:237 errors:0 dropped:0 overruns:0 frame:0
TX packets:198 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:1000
RX bytes:25429 (24.8 KiB)  TX bytes:26910 (26.2 KiB)
Interrupt:18 Base address:0x2000
eth0:0    Link encap:Ethernet  HWaddr 00:0C:29:28:FD:4C
inet addr:172.16.16.126  Bcast:172.16.16.100  Mask:255.255.255.224
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
Interrupt:18 Base address:0x2000
eth0:1    Link encap:Ethernet  HWaddr 00:0C:29:28:FD:4C
inet addr:172.16.16.127  Bcast:172.16.16.100  Mask:255.255.255.224
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
Interrupt:18 Base address:0x2000
eth0:2    Link encap:Ethernet  HWaddr 00:0C:29:28:FD:4C
inet addr:172.16.16.128  Bcast:172.16.16.100  Mask:255.255.255.224
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
Interrupt:18 Base address:0x2000

Ping each of them from different machine. If everything setup correctly, you will get a ping response from each of them.

ping 172.16.16.126
ping 172.16.16.127
ping 172.16.16.128

Sample Output

[root@tecmint ~]# ping 172.16.16.126
PING 172.16.16.126 (172.16.16.126) 56(84) bytes of data.
64 bytes from 172.16.16.126: icmp_seq=1 ttl=64 time=1.33 ms
64 bytes from 172.16.16.126: icmp_seq=2 ttl=64 time=0.165 ms
64 bytes from 172.16.16.126: icmp_seq=3 ttl=64 time=0.159 ms
--- 172.16.16.126 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2002ms
rtt min/avg/max/mdev = 0.159/0.552/1.332/0.551 ms
[root@tecmint ~]# ping 172.16.16.127
PING 172.16.16.127 (172.16.16.127) 56(84) bytes of data.
64 bytes from 172.16.16.127: icmp_seq=1 ttl=64 time=1.33 ms
64 bytes from 172.16.16.127: icmp_seq=2 ttl=64 time=0.165 ms
64 bytes from 172.16.16.127: icmp_seq=3 ttl=64 time=0.159 ms
--- 172.16.16.127 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2002ms
rtt min/avg/max/mdev = 0.159/0.552/1.332/0.551 ms
[root@tecmint ~]# ping 172.16.16.128
PING 172.16.16.128 (172.16.16.128) 56(84) bytes of data.
64 bytes from 172.16.16.128: icmp_seq=1 ttl=64 time=1.33 ms
64 bytes from 172.16.16.128: icmp_seq=2 ttl=64 time=0.165 ms
64 bytes from 172.16.16.128: icmp_seq=3 ttl=64 time=0.159 ms
--- 172.16.16.128 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2002ms
rtt min/avg/max/mdev = 0.159/0.552/1.332/0.551 ms

Seems everything working smoothly, With these new IPs’ you can setup virtual sites in Apache, FTP accounts and many other things.
Assign Multiple IP Address Range

If you would like to create a range of Multiple IP Addresses to a particular interface called “ifcfg-eth0“, we use “ifcfg-eth0-range0” and copy the contains of ifcfg-eth0 on it as shown below.

[root@tecmint network-scripts]# cd /etc/sysconfig/network-scripts/
[root@tecmint network-scripts]# cp -p ifcfg-eth0 ifcfg-eth0-range0

Now open “ifcfg-eth0-range0” file and add “IPADDR_START” and “IPADDR_END” IP address range as shown below.

[root@tecmint network-scripts]# vi ifcfg-eth0-range0
#DEVICE="eth0"
#BOOTPROTO=none
#NM_CONTROLLED="yes"
#ONBOOT=yes
TYPE="Ethernet"
IPADDR_START=172.16.16.126
IPADDR_END=172.16.16.130
IPV6INIT=no
#GATEWAY=172.16.16.100

Save it and restart/start network service

[root@tecmint network-scripts]# /etc/init.d/network restart

Verify that virtual interfaces are created with IP Address.

[root@tecmint network-scripts]# ifconfig
eth0      Link encap:Ethernet  HWaddr 00:0C:29:28:FD:4C
inet addr:172.16.16.125  Bcast:172.16.16.100  Mask:255.255.255.224
inet6 addr: fe80::20c:29ff:fe28:fd4c/64 Scope:Link
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
RX packets:1385 errors:0 dropped:0 overruns:0 frame:0
TX packets:1249 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:1000
RX bytes:127317 (124.3 KiB)  TX bytes:200787 (196.0 KiB)
Interrupt:18 Base address:0x2000
eth0:0     Link encap:Ethernet  HWaddr 00:0C:29:28:FD:4C
inet addr:172.16.16.126  Bcast:172.16.16.100  Mask:255.255.255.224
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
Interrupt:18 Base address:0x2000
eth0:1    Link encap:Ethernet  HWaddr 00:0C:29:28:FD:4C
inet addr:172.16.16.127  Bcast:172.16.16.100  Mask:255.255.255.224
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
Interrupt:18 Base address:0x2000
eth0:2    Link encap:Ethernet  HWaddr 00:0C:29:28:FD:4C
inet addr:172.16.16.128  Bcast:172.16.16.100  Mask:255.255.255.224
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
Interrupt:18 Base address:0x2000
eth0:3    Link encap:Ethernet  HWaddr 00:0C:29:28:FD:4C
inet addr:172.16.16.129  Bcast:172.16.16.100  Mask:255.255.255.224
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
Interrupt:18 Base address:0x2000
eth0:4    Link encap:Ethernet  HWaddr 00:0C:29:28:FD:4C
inet addr:172.16.16.130  Bcast:172.16.16.100  Mask:255.255.255.224
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
Interrupt:18 Base address:0x2000

#################################################################################################

Performance and monitoring
ps: shows the list of process
ej: ps -ef | grep <process id>
top: show the system resource usage (the process that are taking more resources)
kill: to stop a process if I use the flag -1 I will restart it, if I use the flag -9 I will force the kill, kill all will kill the process and the childs as well.
nmon: to check the process.
vmstat: statistics of Virtual memory, disks, cpu activity.
iostat: system imput and output storage device statistics.
free: to check memory status.
sar:  collects and display system activity.
To install a package on linux use:
Red Hat: Yum
Susse: Yast
Ubuntu: apt-getf
Ibm aix: installp
To check is a package is install I can use
yum list installed | grep < name of the package>
yum list <name of the package>
To install RPM I use they rpm command
rpm -Uvh <name of the package>
rpm -Uvh foo-1.0-1.i386.rpm
To uninstall RPM
yum remove nmon
yum remove <package name>

To list the installed rpm
rpm -qa
rpm -qi <foo> to check version, release and installed date.
rpm -ql <foo> to check the files of the package.
Linux startup process
1) Post
2) BIOS> looks for the MBR (master boot record)
3) The MBR points boot loader (GRUB)
4) The grub loads the kernel.
5) Then the kernel loads the init (and the script of sysinit starts the system)



Inits
1- Halt
2- Single user log in with no network, command line only
3- Multiuser log in with no network, command line only
4- Full multiuser log in with network, on command line only
5- Reserved for local use only, with limited graphics
6- Multiuser access, with network and full graphic mode
7- Reboot.


CRONTAB
crontab and the cron. * directories Configuration of tasks that need to be executed periodically - backups, updates of the system databases, cleaning of the system, rotating logs etc.
Each line on the /etc/crontab represents a job. In order to program the tasks, I go to the /etc/crontab and enter:
minute hour day month dateofweek command
60 * * * */home/ibadmin/nmoncolector.sh
42 4 1 **/etc/cron.monthly
ANACRON
anacron: Whenever anacron is run, it checks to see when
it last executed each of the programs it’s confi gured to manage. If a period greater than the
program’s execution interval has passed, anacron runs the program.
/etc/anacrontab

Note:
at: You may simply want to run a single command at a specific point in the future on a one-time basis rather than on an ongoing basis. The current daemon for this commands is atd. To list at jobs use the command atq.



Creating a Swap File:
To add a swap file:
1. Determine the size of the new swap file in megabytes and multiply by 1024 to determine the number of blocks. For example, the block size of a 64 mb swap file is 65536.
2. At a shell prompt as root, type the following command with count being equal to the desired block size:
a. dd if=/dev/zero of=swapfile bs=1024 count=65536
3. Set up the swap file with the command:
a. Mkswap /swapfile
4. To enable the swap file immediately but not automatically at boot time:
a. sudo swapon /swapfile
5. To enable it at boot time, edit /etc/fstab to include the following entry:
a. /swapfile swap defaults  0    0


Forgot root’s password
1. We need to edit GRUB2 boot menu and enter user single mode
2. Next, we need to remount / partition to allow read and write
3. Reset the actual root password
4. Set entire system for SElinux relabeling after first reboot
5. Reboot the system from a single mode
Steps to troubleshooting:
1. once you see your GRUB2 boot menu use e key to edit your default boot
2. Scroll down and locate a line with rhgb quiet keywords
3. Move your cursor ( HINT: move to end of the line with CTRL+E ) on rhgb quiet keywords and replace them with init=/bin/bash
4. Once you edit the boot line as show above press CTRL + x to start booting your RHEL 7 system into a single mode. At the end of the system boot you will enter a single mode
5. Once you enter a single your root partition is mounted as Read Only ro. You ca confirm it with the following command:
# mount | grep root
6. In order to mount our partition with Read/Write flag we use mount with a remount option as follows:
# mount -o remount,rw /
7. Next, confirm that the root file system is mounted Read/Write rw:
# mount | grep root
8. Still in the single mode we can proceed with the actual root password recovery. To do this we use passwd command:
# passwd
9. SELinux relabeling
The additional step which needs to be taken on SELinux enables Linux system is to relabel SELinux context. If this step is ommited you will not be able to login with your new root password. The following command will ensure that the SELinux context for entire system is relabeled after reboot:
# touch /.autorelabel
10. The final step when resetting your lost root password on RHEL 7 linux system is to reboot. This can be done with a following command:
# exec /sbin/init




SELinux commands:
getenforce: To see the current status of SELinux, run the “getenforce” command
sestatus: For more detailed SELinux related information use “sestatus” and “sestatus -v” command.
setenforce: The current SELinux status can also be changed with the “setenforce” command as shown below.
chcon: Applies SELinux label to files and directories. If you want to change the settings of a file or directory, you can use the "chcon" command. For example, if you wanted to configure a non-standard directory for an FTP server, you'll want to make sure the context matches the default FTP directory. The permissions of a standard FTP directory can be viewed by using “ls –Z” command. To change the context, use the chcon command. To make the changes recursively use with the -R switch. Change the user and type contexts to match /var/ftp folder using the chcon command.
restorecon: Sets the security context of one or more files by marking the extended attributes with the appropriate file or security context.
fixfiles: Checks or corrects the security context database on the file system.
getsebool: get SELinux boolean value(s)
setsebool: setsebool is used to toggle policy booleans on or off.
ls -Z: shows relevant SELinux information in files.
~]$ ls -Z file1
-rw-rw-r--  user1 group1 unconfined_u:object_r:user_home_t:s0 file1

In this example, SELinux provides a user (unconfined_u), a role (object_r), a type (user_home_t), and a level (s0). This information is used to make access control decisions. On DAC systems, access is controlled based on Linux user and group IDs. SELinux policy rules are checked after DAC rules. SELinux policy rules are not used if DAC rules deny access first.
###########################################################################################


  RESAMAD PROCESS IS HANGIN


Red Hat
	
/etc/init.d/resamad stop
/etc/init.d/resamad start


############################################################################################


-----List all services enabled or disabled at boot time

systemctl list-unit-files --type=service


-----Verify if service is enabled or disabled at boot time

systemctl is-enabled <sshd.service>


-----Verify all services failed loaded

systemctl --failed --type=service


#############################################################################################

IPTABLES


Iptables es un back-end/netfilter o un firewall interno del kernel de linux.


Los tres pasos para una conneccion es son:
 
	1) NEW: crear la connecion
	2) ESTABLISHED: establecer la connecion
	3) RELATED: mantener la connecion

Las tres reglas de configuracion en iptables son:
	
	1) OUTPUT: conneciones de salida
	2) INPUT:  conneciones de entrada
	3) FORWARD: connecciones de reenvio

Comandos:


iptables-save > ~/Desktop/iptables_bck.txt: back up iptables configuration
iptables-restore < ~/Desktop/iptables_bck.txt: restaura la configuration del iptables
iptables -L: list rules configured
iptables -L --line-numbers: muestra el numero de la linea
iptables -F: -F signifcia flush, con ese comando se limpia la configuracion de iptables ****CUIDADO****
iptables -P INPUT ACCEPT: se aceptan conneciones entrantes, -P significa policy
iptables -P INPUT DROP: no llegaran paquetes de entrada
iptables -A INPUT -s <ip>/24 -j ACCEPT: o mascara de subred, permiten y se agrega una regla a la siguiente ip de las conneciones de la ip con su mascara. -A= append, -s=source, -j=jam
iptables -A INPUT -p tcp --dport 5160 -j ACCEPT: se agrega un regla de TCP en el puerto que acepte conneciones. -A=append, -p=protocol, -j=jam
iptables -D INPUT 3: se borra la regla numero 3
iptables -A INPUT -m state --state ESTABLISH,RELATED -j ACCEPT: en la regla de input es usado para aceptar conecciones que entren, pero solo cuando ya se haya establecido una connecion previamente de la fuente hacia el destino.
iptables -A OUTPUT -m state --state NEW,ESTABLISHED -j ACCEPT: en la regla de output es usado para aceptar connecion que salgan.



#############################################################################################

Pre checks commands:

cat << EOF
===============================
Resolv.conf Information:
-------------------------------
$(cat /etc/resolv.conf)
$(sudo cp -p /etc/resolv.conf /etc/resolv.conf.save.`date +%F`)
$(ls -ltr /etc/resolv.conf.save.`date +%F`)

IMPORTANT CONFIGURATION FILES
File
Information/service
Aliases
Mail aliases file for use with the Sendmail and Postfix mail server. Running a mail server on each and every system has long been common use in the UNIX world, and almost every Linux distribution still comes with a Sendmail package. In this file local user names are matched with real names as they occur in E-mail addresses, or with other local addresses.
Apache
Config files for the Apache web server.
Bashrc
The system-wide configuration file for the Bourne Again SHell. Defines functions and aliases for all users. Other shells may have their own system-wide config files, like cshrc.
crontab and the cron.* directories
Configuration of tasks that need to be executed periodically - backups, updates of the system databases, cleaning of the system, rotating logs etc.
Default
Default options for certain commands, such as useradd.
Filesystems
Known file systems: ext3, vfat, iso9660 etc.
Fstab
Lists partitions and their mount points.
ftp*
Configuration of the ftp-server: who can connect, what parts of the system are accessible etc.
Group
Configuration file for user groups. Use the shadow utilities groupadd, groupmod and groupdel to edit this file. Edit manually only if you really know what you are doing.
Hosts
A list of machines that can be contacted using the network, but without the need for a domain name service. This has nothing to do with the system's network configuration, which is done in /etc/sysconfig.
Inittab
Information for booting: mode, number of text consoles etc.
Issue
Information about the distribution (release version and/or kernel info).
ld.so.conf
Locations of library files.
lilo.conf, silo.conf, aboot.conf etc.
Boot information for the LInux LOader, the system for booting that is now gradually being replaced with GRUB.
logrotate.*
Rotation of the logs, a system preventing the collection of huge amounts of log files.
Mail
Directory containing instructions for the behavior of the mail server.
modules.conf
Configuration of modules that enable special features (drivers).
Motd
Message Of The Day: Shown to everyone who connects to the system (in text mode), may be used by the system admin to announce system services/maintenance etc.
Mtab
Currently mounted file systems. It is advised to never edit this file.
nsswitch.conf
Order in which to contact the name resolvers when a process demands resolving of a host name.
pam.d
Configuration of authentication modules.
Passwd
Lists local users. Use the shadow utilities useradd, usermod and userdel to edit this file. Edit manually only when you really know what you are doing.
Printcap
Outdated but still frequently used printer configuration file. Don't edit this manually unless you really know what you are doing.
Profile
System wide configuration of the shell environment: variables, default properties of new files, limitation of resources etc.
rc*
Directories defining active services for each run level.
resolv.conf
Order in which to contact DNS servers (Domain Name Servers only).
sendmail.cf
Main config file for the Sendmail server.
Services
Connections accepted by this machine (open ports).
sndconfig or sound
Configuration of the sound card and sound events.
Ssh
Directory containing the config files for secure shell client and server.
Sysconfig
Directory containing the system configuration files: mouse, keyboard, network, desktop, system clock, power management etc. (specific to RedHat)
X11
Settings for the graphical server, X. RedHat uses XFree, which is reflected in the name of the main configuration file, XFree86Config. Also contains the general directions for the window managers available on the system, for example gdm, fvwm, twm, etc.
xinetd.* or inetd.conf
Configuration files for Internet services that are run from the system's (extended) Internet services daemon (servers that don't run an independent daemon).


Important System Files and Concepts

File
Description
/boot/vmlinuz
The Linux kernel file.  File naming conventions may include release information
/dev/fd0
Device file for the first floppy disk drive on the system
/dev/fd0H1440
Device driver for the first floppy drive in high density mode, commonly invoked when formatting a floppy diskette for that density
/dev/hda
Device file for the first IDE hard drive on the system
/dev/hdc
Commonly, the IDE CDROM drive device file which often is a symbolic link called to /dev/cdrom, the real CDROM driver file.
/dev/null
A dummy device which contains nothing.  It is sometimes useful to send output to this device to make it go away forever.
/etc/aliases
Contains aliases used by sendmail and other mail transport agents. Whenever this file is changed, the newaliases utility must be run to notify sendmail of the changes
/etc/bashrc
Contains global defaults and aliases used by the bash shell
/etc/crontab
A parent shell script to run commands periodically.  It invokes hourly, daily, weekly, and monthly scripts.
/etc/exports
Contains a list of filesystems which may be made available to other systems on the network via NFS.
/etc/fstab
The file system table contains the description of what disk devices are available at what mount points.
/etc/group
Holds information regarding security group definitions.
/etc/grub.conf
The grub boot loader configuration file
/etc/hosts
Contains host names and their corresponding IP addresses used for name resolution whenever a DNS server is unavailable
/etc/hosts.allow
Contains a list of hosts allowed to access services on this computer.
/etc/hosts.deny
Contains a list of hosts forbidden to access services on this computer.
/etc/inittab
Describes how the INIT process should set up the system in various runlevels.
/etc/issue
Contains the pre-login message, often overwritten by the /etc/rc.d/rc.local script in Red Hat and some other rpm-based Linux distributions.
/etc/lilo.conf
The lilo boot loader configuration file
/etc/modules.conf
Holds options for configurable system modules
/etc/motd
This is the ?message of the day? file which is printed upon login. It can be overwritten by /etc/rc.d/rc.local Red Hat on startup.
/etc/mtab
Status information for currently mounted devices and partitions
/etc/passwd
Contains information regarding registered system users. Passwords are typically kept in a shadow file for better security.
/etc/printcap
Holds printer setup information
/etc/profile
Contains global defaults for the bash shell
/etc/resolv.conf
A list of domain name servers (DNS) used by the local machine
/etc/securetty
This file contains a list of terminals where root can login
/etc/termcap
An extensive ASCII text file defining the properties of consoles, terminals, and printers
/proc/cpuinfo
Contains CPU related information
/proc/filesystems
Holds information regarding filesystems that are currently in use
/proc/interrupts
Stores the interrupts that are currently being used
/proc/ioports
A list of the I/O addresses used by devices connected to the server
/proc/meminfo
Contains memory usage information for both physical memory and swap
/proc/modules
Lists currently loaded kernel modules
/proc/mounts 
Displays currently mounted file systems
/proc/stat
Contains various statistics about the system, such as the number of page faults since the system was last booted
/proc/swaps
Holds swap file utilization information
/proc/version
Contains Linux version information
/var/log/lastlog
Stores information about the last boot process
/var/log/messages
Contains messages produced by the syslog daemon during the boot process
/var/log/wtmp
A binary data file holding login time and duration for each user currently on the system
/bin
Binaries (executables). Basic system programs and utilities (such as bash).
•/sbin
System binaries. Basic system administrative programs and utilities (such as fsck).
•/etc
 Systemwide configuration files.
Of particular interest are the /etc/fstab (filesystem table), /etc/mtab (mounted filesystem table), and the /etc/inittab files.
•/usr/man
The systemwide manpages.
•/dev
Device directory. Entries (but not mount points) for physical and virtual devices.
•/proc
Process directory. Contains information and statistics about running processes and kernel parameters.
•/sys
Systemwide device directory. Contains information and statistics about device and device names. This is newly added to Linux with the 2.6.X kernels.
•/mnt
Mount. Directory for mounting hard drive partitions, such as /mnt/dos, and physical devices. In newer Linux distros, the /media directory has taken over as the preferred mount point for I/O devices.
•/media
In newer Linux distros, the preferred mount point for I/O devices, such as CD/DVD drives or USB flash drives.
•/var
Variable (changeable) system files. This is a catchall "scratchpad" directory for data generated while a Linux/UNIX machine is running.
•/var/log
•/var/log/messages

Systemwide log files.
•/lib
Systemwide library files.
•/tmp
System temporary files.
•/boot
System boot directory. The kernel, module links, system map, and boot manager reside here.
/home/ — Default location of user home directories.
/root/.rhosts: Defines which remote hosts (computers on a network) can invoke certain commands on the local host without supplying a password
/opt/ — Directory where optional files and programs are stored. This directory is used mainly by third-party developers for easy installation and uninstallation of their software packages.
DMA Addresses: Direct memory addressing (DMA) is an alternative method of communication to I/O ports. Rather than have the CPU mediate the transfer of data between a device and memory, DMA permits the device to transfer data directly, without the CPU’s attention.
Socket files: are those commands that are used to send information among applications. You can consider a socket file to be part of the entire connection mechanism that two programs set up when they need to exchange information via a socket
Disk quotas: Disk space can be restricted by implementing disk quotas which alert a system administrator before a user consumes too much disk space or a partition becomes full
Systemd: Sistema de arranque. Plataforma de administración y configuración central para interactuar con el núcleo del Sistema operativo.
SysV: El sistema de inicio System V controla el arranque de los programas en el instante de inicio de la máquina. Llamado también estilo de arranque (init)
/etc/skel: The /etc/skel directory contains files and folders that will be copied in the new user’s home directory (login directory), when that user is created with useradd or other commands. The skeleton directory, /etc/skel, allows the administrator (the root user) to create new users having the same files and folders in their home directories.
Logrotate: The logrotate program consults a confi guration fi le called /etc/logrotate.conf, which includes several default settings andtypically refers to fi les in /etc/logrotate.d to handle specific log files.
----------------------------------------------------------------------------------------------------

Displays nice level for processes

ps axo pid, comm,nice --sort=-nice


------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


!!!!!!!!!!!!!!!!!!!!!VALIDAR VM Y SI ESTA EN READ ONLY = RO!!!!!!!!!!!!!!!!!!!!!

correr script ./multiserver.sh | tee /home/brodriguez/Desktop/logs.txt

echo -------------------
hostname;
uptime;
egrep " ro,|,ro " /proc/mounts


Si el filesystem esta en read only:

egrep " ro,|,ro " /proc/mounts 

Ejemplo:

#brodriguez$RHEL: egrep " ro,|,ro " /proc/mounts 
/dev/sda3 / ext4 ro,seclabel,relatime,barrier=1,data=ordered 0 0    
/dev/sda5 /var ext4 ro,seclabel,relatime,barrier=1,data=ordered 0 0
------------------------------------------------------------------------------------------------------

CHECKING FAILURE SSH ATTEMPS

sudo pam_tally2 --user=cinstall


grep "Failed password" /var/log/auth.log

------------------------------------------------------------------------------------------------------

		CHECKING HEARTHBEAT 

[ibmadmin@jp0811fgl3008 ~]$ sudo cat /opt/IBM/ITM/config/ul.ini |grep -i CTIRA_HEARTBEAT


------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

JACCLIENT ISSUE #1

bmadmin@usbd11z0e1017$ sudo cat /opt/IBM/SCM/client/client.pref |egrep -i 'Bindaddr|Client|server'

$ sudo vi /opt/IBM/SCM/client/client.pref

ibmadmin@usbd11z0e1017$ sudo /opt/IBM/SCM/client/jacclient status

ibmadmin@usbd11z0e1017$ sudo /opt/IBM/SCM/client/jacclient start
_______________________________________________________________________________________________

JACCLIENT ISSUE #2


sudo /opt/IBM/SCM/client/jacclient status

sudo /opt/IBM/SCM/client/jacclient start

sudo /opt/IBM/SCM/client/jacclient status

sudo ps -ef |grep -i SCM |grep -v grep

________________________________________________________________________________________________

RSYSLOGD - process missing

sudo /etc/init.d/syslog status

sudo cat /etc/sysconfig/syslog |grep -i SYSLOG_DAEMON

sudo ps -ef |grep -i syslog-ng |grep -v grep

sudo chkconfig syslog-ng on


___________________________________________________________________________________________________

ATD-PROCESS-MISSING

sudo service atd status

sudo service atd start

sudo chkconfig atd on

sudo chkconfig --list | grep -i atd
___________________________________________________________________________________________________

XINETD-MISSING-PROCESS


sudo ps -ef |grep -i xinetd |grep -v grep

sudo service xinetd status

sudo rpm -qa xinetd

sudo yum list xinetd

se le manda correo al dpe informando que no esta instalado. Si se requiere se necesita aprobacion.

___________________________________________________________________________________________________

Vmware-Tools- #RHEL7


sudo cat /etc/redhat-release

sudo /etc/init.d/vmware-tools status

sudo /etc/init.d/vmware-tools status

sudo /etc/init.d/vmware-tools start

sudo /etc/init.d/vmware-tools restart

sudo /sbin/chkconfig vmware-tools on -----systemctl en rhel 7

sudo systemctl status vmware-tools

Si el proceso esta detenido

[osadmin@bdcaprodsrch03 ~]$ sudo systemctl start vmware-tools
[osadmin@bdcaprodsrch03 ~]$ sudo systemctl enable vmware-tools (persistente)

sudo /sbin/chkconfig vmware-tools on

sudo systemctl status vmware-tools

__________________________________________________________________________________________________

Vmware-Tools-#RHEL6

sudo status vmware-tools

sudo start vmware-tools

/etc/vmware-tools/services.sh status

sudo chkconfig vmware-tools on

Si se complica:

/usr/bin/vmware-config-tools.pl

_________________________________________________________________________________________________

Vmware-Tools-#RHEL5


sudo /etc/init.d/vmware-tools status

sudo /etc/init.d/vmware-tools start

sudo chkconfig vmware-tools on

__________________________________________________________________________________________________

			NOT ABLE TO LOGIN VIA SSH

[osadmin@catr11z2p2060 ~]$ sudo grep -i permitroot /etc/ssh/sshd_config
PermitRootLogin no
[osadmin@catr11z2p2060 ~]$ sudo vi /etc/ssh/sshd_config
[osadmin@catr11z2p2060 ~]$ sudo service sshd restart
Stopping sshd:                                             [  OK  ]
Starting sshd:                                             [  OK  ]
[osadmin@catr11z2p2060 ~]$ sudo grep -i permitroot /etc/ssh/sshd_config
PermitRootLogin without-password
[osadmin@catr11z2p2060 ~]$ 


__________________________________________________________________________________________________





			ITM AGENT OFFLINE

sudo /opt/IBM/ITM/bin/cinfo -r
sudo /opt/IBM/ITM/bin/itmcmd agent -f stop ul
sudo /opt/IBM/ITM/bin/itmcmd agent stop all
sudo /opt/IBM/ITM/bin/itmcmd agent start all

sudo service crond status

sudo service crond start

sudo service crond status

sudo chkconfig crond on
##################################################################################

			ITM AGENT OFFLINE


qca#Close Expired: ITM Agent Offline: SCTAB2BI.:qca_au02cms01b2bi64:MQ

Close Expired: ITM Agent Offline: SCTAB2BI.:qca_au02cms01b2bi64:MQ

TicketGroup: I-SSO-IN-OPS-COP
Date: 12/06/2018	Severity: Major
ResourceId: au02cms01b2bi64.adm.qca.syd.ssm.sdc.gts.ibm.com
Customer Hostname: au02cms01b2bi64

InstanceId: REMOTE_au04rtm011ccpr1
InstanceSituation: MS Agent Status
InstanceValue: Offline
ComponentType: ManagementInfrastructure
Component: ITM6Agent
SubComponent: Status:MQ
ApplId: ITM
MsgId: TIVTSA084E
Node: qca_au02cms01b2bi64
NodeAlias: 172.18.71.203
Manager: EIF Probe on au04mni031ccpxa
Agent: EIF Probe on au04mni031ccpxa
AlertKey: ccp_ms_offline
AlertGroup: ITM_ManagedSystem
EventKey: AU04MNI031A:93053:qca

RESOLUTION:


/opt/IBM/ITM/bin/itmcmd agent -o REMOTE start mq
/opt/IBM/ITM/bin/itmcmd agent -o SCTAB2BI start mq

##################################################################################

					ITM Agents
###################################################################################

Install/Reinstall BaseOS Agents

Montar la NIM:
mount 146.89.141.138:/sds /sds

Crear directorio temporal:
mkdir /tmp/ITMBaseOSAgent/

Copiar software:
cp /sds/local/sceplus/agents/ITM/ITM6_AIX_64_06230300_SCE.tar /tmp/ITMBaseOSAgent/

Descomprimir software:
cd /tmp/ITMBaseOSAgent/
tar -xvf /tmp/ITMBaseOSAgent/ITM6_AIX_64_06230300_SCE.tar

Instalar el software:
cd /tmp/ITMBaseOSAgent/TEMA1/
./esm_instTEMA.sh -t ux -a aix526 -h /opt/IBM/ITM -r 146.89.140.53 -f 146.89.140.55 -c <customer_code> -l <servername>

Ejemplo:
./esm_instTEMA.sh -t ux -a aix526 -h /opt/IBM/ITM -r 146.89.140.53 -f 146.89.140.55 -c ger -l ggaap013

Importante: sumo cuidado al indicar el código del cliente y el hostname.

Uninstall ITM Agents

sudo /opt/IBM/ITM/bin/uninstall.sh

Importante: este script no debe de ser utilizado si se tiene otro agente registratdo que no es BaseOS, ya que esto remueve la configuración de ese agente, se recomienda reinstalar en todo caso.
Comandos

Verificar si los agentes se están ejecutado:
/opt/IBM/ITM/bin/cinfo -r
sudo /opt/IBM/ITCAMUD/bin/cinfo -i

Iniciar todos los agentes:
/opt/IBM/ITM/bin/itmcmd agent start all

Detener todos los agentes:
/opt/IBM/ITM/bin/itmcmd agent stop all

Detener un agente forzadamente:
itmcmd agent -p INST1 -f stop um

Iniciar agente de SAP:
/opt/IBM/ITM/bin/itmcmd agent -o QEH start sa

Importante: el QEH en este caso es el identificador del sistema / instancia.

ITM Agents Legacy MSD

/opt/monitor/IBM/ITM/bin/cinfo -r
/opt/monitor/IBM/ITM/bin/itmcmd agent start all
/opt/monitor/IBM/ITM/bin/itmcmd agent -o PRO start sa
/opt/monitor/IBM/ITM/bin/itmcmd agent -o PRO stop mq
/opt/monitor/IBM/ITM/bin/itmcmd agent -o PPDP1BO start rz

To see installed ITM agents:
sudo /opt/monitor/IBM/ITM/bin/cinfo -i

*For further troubleshoot on ITM contact Geovanni de Jesus Rey Hernandez or Domingo Rangel

If alert doesn't go cleared run the following as root.
cd /tmp
sudo tar xvf /sds/local/sceplus/agents/ITM/ITM6_AIX_64_06300700_CMS1.tar
cd TEMA1
./esm_instTEMA.sh -t ux -a aix526 -h /opt/IBM/ITM -r 146.89.140.52 -f 146.89.140.53 -c per -l `hostname`

/opt/IBM/ITM/logs   for ITM logs

#####

$ sudo /opt/IBM/ITM/bin/cinfo -r

*********** Thu Apr 26 16:35:38 BRT 2018 ******************
User: root Groups: system sapinst tivlogs
Host name : ndbrpiprd01  Installer Lvl:06.23.03.00
CandleHome: /opt/IBM/ITM
***********************************************************
Host         Prod  PID       Owner  Start  ID    ..Status
ndbrpiprd01  ul    13369560  root   Dec12  None  ...running  (*ndbrpiprd01 cambiar esto)
ndbrpiprd01  oy    7077950   root   Oct22  PPN   ...running
ndbrpiprd01  px    11599936  root   Oct22  None  ...running
ndbrpiprd01  sa    9961676   root   Oct22  PPN   ...running
ndbrpiprd01  um    12451932  root   Oct22  None  ...running
ndbrpiprd01  ux    5963928   root   Oct22  None  ...running

sudo /opt/IBM/ITM/bin/itmcmd agent -f stop all
sudo /opt/IBM/ITM/bin/cinfo -c ux
sudo /opt/IBM/ITM/bin/uninstall.sh REMOVE EVERYTHING
cd /tmp
sudo rm -Rf TEMA1
tar -xf /sds/local/sceplus/agents/ITM/ITM6_AIX_64_06300700_CMS1.tar ; cd TEMA1
sudo ./esm_instTEMA.sh -t ux -a aix526 -h /opt/IBM/ITM -r 146.89.140.52 -f 146.89.140.54 -l <ndbrpiprd01> -c nnw

Verificación:
sudo /opt/IBM/ITM/bin/cinfo -r
df -g /opt/IBM/ITM
###################################################################################


IN8335042 - ITM Agent Offline



###################################################################################

Pasos:

1. Verificar que el agente se esté ejecutando.
2. En caso de que no se esté ejecutando iniciar el agente.
3. Si el agente ya se está ejecutando se debe reiniciar.
4. Esperar a que la alerta se limpie en el incidente.
5. De no funcionar, se deben reinstalar los agentes base de ITM.
6. En caso de que tras la reinstalación no se limpie la alerta, se debe contactar a Geovanni de Jesus Rey Hernandez.

$ sudo /opt/IBM/ITM/bin/cinfo -r

*********** Wed May  2 19:15:03 CEST 2018 ******************
User: root Groups: system sapinst tivlogs
Host name : valsapgp101  Installer Lvl:06.23.03.00
CandleHome: /opt/IBM/ITM
***********************************************************
Host         Prod  PID       Owner  Start  ID    ..Status
valsapgp101  px    5898336   root   Feb16  None  ...running
valsapgp101  rz    7667900   root   Feb16  GP1   ...running
valsapgp101  ul    8912934   root   Feb16  None  ...running
valsapgp101  ux    10289224  root   Feb16  None  ...running
valsapgp101  sa    19136594  root   Feb21  GP1   ...running

$ sudo /opt/IBM/ITM/bin/itmcmd agent -o GP1 stop rz
Processing. Please wait...
Stopping Monitoring Agent for Oracle Database Extended ...
Product Monitoring Agent for Oracle Database Extended was stopped gracefully.
Agent stopped...

$ sudo /opt/IBM/ITM/bin/itmcmd agent -o GP1 start rz
Processing. Please wait...
Starting Monitoring Agent for Oracle Database Extended ...
Monitoring Agent for Oracle Database Extended started

$ sudo /opt/IBM/ITM/bin/cinfo -r

*********** Wed May  2 19:35:48 CEST 2018 ******************
User: root Groups: system sapinst tivlogs
Host name : valsapgp101  Installer Lvl:06.23.03.00
CandleHome: /opt/IBM/ITM
***********************************************************
Host         Prod  PID       Owner  Start     ID    ..Status
valsapgp101  px    5898336   root   Feb16     None  ...running
valsapgp101  ul    8912934   root   Feb16     None  ...running
valsapgp101  ux    10289224  root   Feb16     None  ...running
valsapgp101  sa    19136594  root   Feb21     GP1   ...running
valsapgp101  rz    38207538  root   19:35:27  GP1   ...running

__________________________________________________________________________________________________

BESClient


ps -ef |grep -i BESClient |grep -v grep
/etc/inid.d/besclient status
/etc/inid.d/besclient start


BESAgent-9.5.8.38-rhe5.x86_64
mkdir: cannot create directory `/var/opt/BESClient/': File exists
mkdir: cannot create directory `/etc/opt/BESClient/': File exists
Starting IBM BigFix: BESClient:                            [  OK  ]
Connection to 172.18.71.84 closed.
HOSTNAME: rjrw4101
BESClient (pid 2497) is running...


___________________________________________________________________________________________________

NTPD - RHEL7


sudo cat /etc/redhat-release

sudo systemctl status ntpd

sudo systemctl start ntpd

sudo systemctl enable ntpd

___________________________________________________________________________________________________

CCP - usbdovm011ccpr1: High space used
(80%) for SWAP

$ free -m
$ swapoff -a
$ swapon -a

Si la memoria esta llena y no permite volcarla:

1. Hablar con el DPE y un mae de apps para que bajen las aplicaciones y liberar memoria.(ultimo recurso)
2. Hacer crecer el LV de swap. (revisar si hay espacio)
3. Crear un swap file para agregar swap. (revisar si hay espacio)

___________________________________________________________________________________________________

FILE SYSTEM 80%

sudo df -P | awk '0+$5 >= 80 {print}'
cd /<filesystem>
sudo du -sh * |grep G
find -size 10M
find -size +10G
find -size -10k
sudo du -mxs * | sort -nbr | head -10


___________________________________________________________________________________________________

VM-REBOOTED - PRE-POSTCHECK

***verify if IN is part of a change...that's why it may be the cause of the reboot***

run the following commands (some won't work on versions 5-6-7 of RHEL):

date
uptime
hostname
uname -a
cat /etc/redhat-release
sudo df -hT
sudo sar 5 5
cat /etc/fstab
mount |grep nfs
grep -i -E --color 'nfs | cif' /etc/fstab
sudo /opt/IBM/ITM/bin/cinfo -r
lspci
ifconfig -a


cat /var/log/messages
cat /var/log/secure
cat /var/log/boot.log
/etc/rsyslog.d/auth-errors.conf
/var/log/auth-errors
journal -f
journalctl -n 5
journal -p err
journalctl --since today
journalctl --since 9:05:00 --until 9:15;00
journalctl --since "2014-02-10 20:30:00" --until "2014-02-13 12:00:00"



_____________________________________________________________________________________________


		SET LOGS FOR NFS


    Use rpcdebug to set and clear the Linux kernel’s NFS client and server debug flags. Setting these flags causes the kernel to emit messages to the system log in response to NFS activity. Kindly run following command on NFS client. Which will log all activities in the "/var/log/messages":

Raw

# rpcdebug -m nfs -s all

    To revert the changes (i.e. to disable the NFS logs on client which you have enabled using "rpcdebug"), use following command to clear the given debug flags:

Raw

# rpcdebug -m nfs -c all

    There are some modules for "-m" option.
        nfsd: the NFS server.
        nfs: the NFS client.
        nlm: the Network Lock Manager.
        rpc: The Remote Procedure Call module,




_____________________________________________________________________________________________

				Workload High (94, CPU:-1)

sudo sar 5 5

nmon
    --->4,t,4

topas

se analiza cual es el proceso que esta consumiendo, si es APPS se pasa el incidente a APPS y se le dice al dpe

______________________________________________________________________________________________



Para que dejen de decir que yo no comparto nada jaja...

Cuando reciban eventos (en este caso ABN AMRO) con el siguiente titulo:
> vm00001681 Script: description: Ereg checking, script result: A0B0D0E0F1, Command: /opt/IBM/ITM4CMS/

Ojo, ABN AMRO usa /opt/IBM/ITM4CMS/ no opt/IBM/ITM/

Para la atencion de esos eventos en lo que hay que enfocarse es en: *A0B0D1E0F1*

A, B, C, D, E y F son validaciones, si la validacion es satisfactoria, entonces la letra
va acompanada de un 0, en caso de ser erronea, un 1.

Para ese caso de ejemplo, el error esta en F1

Este seria el detalle completo:
```### CODE EXPLANATIONS ### 
# 1 - means - found error in one group's checking
# 0 - means - It is OK in one groups's checking
#
#A1 = Error: EREG log is not generated today
#A0 = OK:    EREG log exists
#B1 = Error: EREG log exist, but host is not found in LDAP. Check LDAP registration
#B0 = OK:    EREG log exists and not found any errors in LDAP registration

# Temporarly deactivate
RPM_CHECK=0  # 1 - activate checking, 0 - deactivate checking
#C1 = Error: RPM (ereg) package isn't in proper version
#C0 = OK:    RPM (ereg) package is in proper version

#D1 = Error: Check CRON: update_sshv4.pl is commented
#D0 = OK:    update_sshv4.pl in CRON isn't commented, it should works
#E1 = Error: File /opt/eregldap/uar/configure/customvar.cfg doesn't exists
#E0 = OK:    File /opt/eregldap/uar/configure/customvar.cfg exists
#F1 = Error: TESTMODE is enabled in /opt/eregldap/uar/configure/customvar.cfg
#F0 = OK:    TESTMODE is disabled in /opt/eregldap/uar/configure/customvar.cfg```

Entonces para esa F1:
> F1 = Error: TESTMODE is enabled in /opt/eregldap/uar/configure/customvar.cfg

La solucion seria cambiar el TESTMODE de customvar.cfg a 0 (false).
Y asi por cada una, dependiendo de la alerta que reciban.

Para probar, pueden volver a correr el script de validacion:
> [osadmin@vm00001681 ~]$ sudo /opt/IBM/ITM4CMS/smitools/scripts/k08_ereg_check.sh
> A0B0D0E0F0
> [osadmin@vm00001681 ~]$ echo $?
> 0

El resultado deberia estar todo en cero: *A0B0D0E0F0* ya con eso se libera la alarma.


______________________________________________________________________________________________

 CANNOT PING TO IP OR WWW.SADSA.COM

En caso los nodos por ejemplo ibmt1porpws02 y ibmt1porpws01, se puede tomar la configuracion de donde
si hace ping y pegar en resolv.conf. Sino, se debe revisar dns y sino contactar a los de network que chequeen dns

[osadmin@ibmt1porpws02 ~]$ date
Wed Aug  8 15:54:15 UTC 2018
[osadmin@ibmt1porpws02 ~]$ cat /etc/redhat-release
Red Hat Enterprise Linux Server release 7.2 (Maipo)
[osadmin@ibmt1porpws02 ~]$ uname -a
Linux ibmt1porpws02 3.10.0-514.6.1.el7.x86_64 #1 SMP Sat Dec 10 11:15:38 EST 2016 x86_64 x86_64 x86_64 GNU/Linux
[osadmin@ibmt1porpws02 ~]$ uptime
 15:54:26 up 19 days, 20:20,  2 users,  load average: 0.00, 0.04, 0.05
[osadmin@ibmt1porpws02 ~]$
[osadmin@ibmt1porpws02 ~]$
[osadmin@ibmt1porpws02 ~]$ cat /etc/resolv.conf
# Generated by NetworkManager
[osadmin@ibmt1porpws02 ~]$traceroute www.uol.com.br
www.uol.com.br: Name or service not known
Cannot handle "host" cmdline arg `www.uol.com.br' on position 1 (argc 1)
[osadmin@ibmt1porpws02 ~]$ cat /etc/resolv.conf
# Generated by NetworkManager
[osadmin@ibmt1porpws02 ~]$ sudo vi /etc/resolv.conf   #####AQUI SE PEGA LA CONF DE LA OTRA MAQUINA####
[osadmin@ibmt1porpws02 ~]$
[osadmin@ibmt1porpws02 ~]$ cat /etc/resolv.conf
# Generated by NetworkManager
search adm.hrt.ssm.sdc.gts.ibm.com ibr.hrt.ssm.sdc.gts.ibm.com ime.hrt.ssm.sdc.gts.ibm.com
nameserver 146.89.111.10
nameserver 146.89.111.11
[osadmin@ibmt1porpws02 ~]$ traceroute www.uol.com.br
traceroute to www.uol.com.br (143.204.15.43), 30 hops max, 60 byte packets
 1  brho11ime1002.ime.hrt.ssm.sdc.gts.ibm.com (10.110.1.2)  1.914 ms  1.924 ms  1.959 ms
 2  * * *
 3  10.177.111.129 (10.177.111.129)  1.073 ms  1.076 ms  1.070 ms
 4  170.225.246.130 (170.225.246.130)  1.346 ms  1.370 ms  1.320 ms
 5  78.10.6132.ip4.static.sl-reverse.com (50.97.16.120)  4.587 ms  4.835 ms  4.583 ms
 6  ae12-545.sanpaolo8.spa.seabone.net (149.3.181.82)  71.042 ms  10.881 ms  70.011 ms
 7  ae20.milano51.mil.seabone.net (195.22.205.13)  224.750 ms ae21.milano51.mil.seabone.net (195.22.205.39)  226.426 ms  248.366 ms
 8  amazon.milano51.mil.seabone.net (195.22.196.231)  229.347 ms  229.222 ms  248.103 ms
 9  52.119.155.4 (52.119.155.4)  226.545 ms 52.119.154.192 (52.119.154.192)  248.111 ms 52.119.155.174 (52.119.155.174)  216.044 ms
10  52.119.152.141 (52.119.152.141)  242.351 ms 52.119.152.139 (52.119.152.139)  235.400 ms 52.119.152.143 (52.119.152.143)  224.632 ms
11  * * *
12  * * *
13  * * *
14  * * *
15  *^C
[osadmin@ibmt1porpws02 ~]$ ping www.uol.com.br
PING dftex7xfha8fh.cloudfront.net (143.204.15.109) 56(84) bytes of data.
64 bytes from 143.204.15.109: icmp_seq=1 ttl=239 time=245 ms
64 bytes from 143.204.15.109: icmp_seq=2 ttl=239 time=245 ms
64 bytes from 143.204.15.109: icmp_seq=3 ttl=239 time=245 ms
64 bytes from 143.204.15.109: icmp_seq=4 ttl=239 time=248 ms
^C
--- dftex7xfha8fh.cloudfront.net ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3000ms
rtt min/avg/max/mdev = 245.419/246.218/248.531/1.335 ms
[osadmin@ibmt1porpws02 ~]$ 10.110.1.6


__________________________________________________________________________________________

CONSULTAR LUN MAPPER

cat /proc/scsi/scsi
ls -ld /sys/block/sd*/device

_______________________________________________________________________________________

ADD USER WITH DEFAULT SETTINGS

groupadd <GROUP> -g <GUID>
useradd <USER> -u <UUID> -g <GUID>

sudo chage -m 1 <USER>
sudo chage -l <USER>
sudo chage -M 90 <USER>
sudo chage -W 7 <USER>
sudo chage -d 0 <USER>

chage -I -1 -m 0 -M 99999 -E -1 username

sudo vim /opt/eregldap/uar/configure/protectedid.dat
______________________________________________________________________________________

VIEW PROCESSES INFO

$ ps
  PID TTY          TIME CMD
 1830 tty1     00:00:01 -bash
 1849 tty1     00:00:00 ps
$ ls -l /proc/1830
total 0
-r--r--r--   1 ajax   users        0 Feb 21 10:45 cmdline
lrwxrwxrwx   1 ajax   users        0 Feb 21 10:45 cwd =-> /home/ajax
-r--------   1 ajax   users        0 Feb 21 10:45 environ
lrwxrwxrwx   1 ajax   users        0 Feb 21 10:45 exe -> /bin/bash
dr-x------   2 ajax   users        0 Feb 21 10:45 fd
pr--r--r--   1 ajax   users        0 Feb 21 10:45 maps
-rw-------   1 ajax   users        0 Feb 21 10:45 mem
lrwxrwxrwx   1 ajax   users        0 Feb 21 10:45 root -> /
-r--r--r--   1 ajax   users        0 Feb 21 10:45 stat
-r--r--r--   1 ajax   users        0 Feb 21 10:45 statm
-r--r--r--   1 ajax   users        0 Feb 21 10:45 status
$ tr '\0' '\n' < /proc/1830/environ
TERM=console
HOME=/home/ajax
PATH=/bin:/usr/bin
SHELL=/bin/bash
MAIL=/var/mail/ajax
LOGNAME=ajax
_____________________________________________________________________________________

DEVICE IS BUSY

$ umount /home
umount: /home: device is busy
$ ls -l /proc/*/fd | grep /home
lrwx------ 1 root     root       64 May 17 13:33 1 -> /home/ajax/myprog
$


_______________________________________________________________________________________

Fix rpmdb: Thread died in Berkeley DB library

mkdir /var/lib/rpm/backup
cp -a /var/lib/rpm/__db* /var/lib/rpm/backup/
rm -f /var/lib/rpm/__db.[0-9][0-9]*
rpm --quiet -qa
rpm --rebuilddb
yum clean all

echo dbus;
sudo chage -l dbus;
echo vcsa;
sudo chage -l vcsa;
echo haldaemon;
sudo chage -l haldaemon;
echo ntp;
sudo chage -l ntp;
echo postfix;
sudo chage -l postfix;
echo rpcuser;
sudo chage -l rpcuser;
echo nfsnobody;
sudo chage -l nfsnobody;
echo sshd;
sudo chage -l sshd;
echo tcpdump;
sudo chage -l tcpdump;
echo oprofile;
sudo chage -l oprofile;
echo avahi;
sudo chage -l avahi;
echo gdm;
sudo chage -l gdm;
echo mysql;
sudo chage -l mysql;

_____________________________________________________________________________________


Archivos de logs comunes


    /var/log/messages : General message and system related stuff
    /var/log/auth.log : Authenication logs
    /var/log/kern.log : Kernel logs
    /var/log/cron.log : Crond logs (cron job)
    /var/log/maillog : Mail server logs
    /var/log/qmail/ : Qmail log directory (more files inside this directory)
    /var/log/httpd/ : Apache access and error logs directory
    /var/log/lighttpd/ : Lighttpd access and error logs directory
    /var/log/boot.log : System boot log
    /var/log/mysqld.log : MySQL database server log file
    /var/log/secure or /var/log/auth.log : Authentication log
    /var/log/utmp or /var/log/wtmp : Login records file
    /var/log/yum.log : Yum command log file.


&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&										&
&										&
&										&
&										&
&			CHANGES/CAMBIOS STEP BY STEP					&
&										&		&										&
&										&
&										&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&


___________________________________________________________________________________________


Pasos CH CEM:

Teoria:


En incidente verificar:
	logs
	authorization approved:
		dpe approval
		sme approval
	schedule (hora de cambio y comparar con mi hora local)
	attachments : OPS - TASKS
	INCIDENT in progress
	revisar summary and performers y validar disponibilidad
	 

1) CEMPreck
2) Multiserver - OSVALIDATION | tee <filename


Practica:

#validar repositorios#

correr CEMPrecheck 
o
sudo /sds/local/sceplus/sup/Linux/patching/cms_linux_pkg_mgr.sh update


#para hacer pre check
./multi_servers.sh - os_validation | tee <CHANGE#_PRECHECK>



&&&&&&&&&&&&&&&&&&&&&&&&&$$$$$$$$$$$$$$$$
&        				&
&	APAGAR NETWORK MANAGER!!        &
&				        &
&&&&&&&&&&&&&&&&&&&&&&&&&################

#APAGAR
chkconfig --list NetworkManager
service NetworkManager stop
chkconfig NetworkManager off


#comentar nfs
sudo cat /etc/fstab 


sudo systemctl winbind status

sudo /etc/init.d/winbind status
sudo /etc/init.d/xinetd status
sudo /etc/init.d/sssd status
sudo /etc/init.d/rpcbind status
sudo /etc/init.d/nfsd status
sudo /etc/init.d/nfs status
sudo /etc/init.d/postfix status
sudo /etc/init.d/autofs status
sudo /etc/init.d/dsmcad status
sudo /etc/init.d/dsmcad_DAY status
sudo /etc/init.d/vncserver status

sudo /opt/IBM/ITM/bin/itmcmd agent start all
sudo /opt/IBM/ITM/bin/itmcmd agent stop all
sudo /opt/IBM/ITM/bin/cinfo -r 
sudo /opt/IBM/ITM/bin/itmcmd agent start -oy sa -O GRD
sudo /opt/IBM/ITM/bin/itmcmd agent start -oy sa -o GRD
sudo /opt/IBM/ITM/bin/itmcmd agent -o GRD start sa
sudo /opt/IBM/ITM/bin/cinfo -r 


descomentar /etc/fstab
mount -a

#ENCENDER
dejar network como estaba
chkconfig network on

./multi_servers.sh | tee <postcheck file name>
diff -y <file1> <file2>


____________________________________________________________________________________________





RHSA CHANGE

Comandos:

Para sacar la informacion del archivo con los patch id's:

cat CH1365068_Z3H.csv | grep -i LCMSQGMD002 | cut -d, -f 3 | awk '{ print "sudo yum list-sec --enablerepo=* --disablerepo=gold | grep " "\""$1"\""}'


cat CH1365068_Z3H.csv | grep -i LCMSQGMD002 | cut -d, -f 3 | awk '{ print "sudo yum -y update --enablerepo=* --disablerepo=gold --advisory=" "\""$1"\""}


primero se hace pre check 


sudo yum repolist all --enablerepo=* --disablerepo=gold;
sudo yum makecache fast --enablerepo=* --disablerepo=gold;

sudo yum list-sec --enablerepo=* --disablerepo=gold | grep "RHSA-2018:2181"
sudo yum -y update --enablerepo=* --disablerepo=gold --advisory="RHSA-2018:2181"

ANTES DE REBOTEAR:

Ensure that the Network Manager service is stopped
# service NetworkManager stop
or
sudo /usr/bin/systemctl start NetworkManager.service

Ensure that the Network Manager service is disabled
sudo chkconfig NetworkManager off 
systemctl disable NetworkManager.service
or
sudo /usr/bin/systemctl enable NetworkManager.service


sudo /usr/bin/systemctl disable NetworkManager.service

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!NO OLVIDAR MOUNT -A DESPUES DEL REBOOT!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!



detener networkmanager

sudo /etc/init.d/winbind status
sudo /etc/init.d/xinetd status
sudo /etc/init.d/sssd status
sudo /etc/init.d/rpcbind status
sudo /etc/init.d/nfsd status
sudo /etc/init.d/nfs status
sudo /etc/init.d/postfix status
sudo /etc/init.d/autofs status
sudo /etc/init.d/dsmcad status
sudo /etc/init.d/dsmcad_DAY status
sudo /etc/init.d/vncserver status

sudo /opt/IBM/ITM/bin/itmcmd agent start all
sudo /opt/IBM/ITM/bin/cinfo -r 
sudo /opt/IBM/ITM/bin/itmcmd agent start cat-oy sa -O GRD
sudo /opt/IBM/ITM/bin/itmcmd agent start -oy sa -o GRD
sudo /opt/IBM/ITM/bin/itmcmd agent -o GRD start sa
sudo /opt/IBM/ITM/bin/cinfo -r 

sudo cat /var/log/yum.log | grep 'Nov 24'

----------------------------------------------------------------

package-cleanup --cleandupes --removenewestdupes

sudo package-cleanup --dupes
sudo package-cleanup --cleandupes

sudo package-cleanup --dupes --removenewestdupes

&&&&&&&&&&&& PARA SACAR INFO DEL EXCEL&&&&&&&&&&&&&&&&&&&&&&&&&&&&&


1. Cambiar el file a .csv
---
2. Sacar los listados

Validar paquete:
cat CH1344584_Z3H.csv | grep -i <equipo> | cut -d, -f 4 | awk '{print "sudo yum list-sec --enablerepo=\* --disablerepo=gold | grep \""$1"\""}'

Actualizar paquete
cat CH1344584_Z3H.csv | grep -i <equipo> | cut -d, -f 4 | awk '{print "sudo yum -y update --enablerepo=\* --disablerepo=gold --advisory=\""$1"\""}'


_______________________________________________________________________________________________


CAMBIO - PARCHEO PARA vHANA - ESXi - vmware

HANA CHANGE:

#######################################################################

sudo openvpn --config /etc/openvpn/dal09.ovpn

ibmbfernandez

Hn!nb4bdA

________________________________________________

!!!!!!!!!!!!!!!!REVISAR DATETIME!!!!!!!!!!!!!!!!!!!!!!!!!
________________________________________________


ls -lha /etc/localtime
date

[ibmbfernandez@BI1BWHDBDEV01 ~]$ ls -lha /etc/localtime
lrwxrwxrwx 1 root root 31 Jan 10  2017 /etc/localtime -> /usr/share/zoneinfo/Asia/Riyadh
[ibmbfernandez@BI1BWHDBDEV01 ~]$ date
Sat Sep  1 18:52:43 AST 2018



BUILDPLAN:

1. SAP engineer to stop all applications and DB running on server as per Stop/Start procedure/doc
2. OS engineer task :
a. OS engineer to take snapshot of server
b. OS engineer to check and note the current timezone on the server before the patching by using the date command
c. Pre-requisite steps : 

-If PHANA and VHANA servers listed, please contact Infra Team Squad members ahead of change.
-For applying RedHat Satellite subscriptions to non-Hana RHEL 6.x VMs only if new packages are not found on this customer VMs:
https://w3-connections.ibm.com/wikis/home?lang=en-us#!/wiki/W4bd546a87fc9_4881_b5c2_79a76bf49b1b/page/RedHat%20Satellite%20infra%20%26%20Chef%20recipe
d. OS team follow the wiki for applying upgrades/patching :
- Please use below wiki if listed server's requiring kernal upgrade and OS can be upgraded to RHEL6.9 :
https://w3-connections.ibm.com/wikis/home?lang=en-us#!/wiki/W4bd546a87fc9_4881_b5c2_79a76bf49b1b/page/OS Upgrade Procedure %28Linux%29
- Please use below wiki if listed server's requires ONLY Security patches/updates, no OS version will be upgraded :
https://w3-connections.ibm.com/wikis/home?lang=en-us#!/wiki/W4bd546a87fc9_4881_b5c2_79a76bf49b1b/page/LSSECFIXES(PATCHING)

NOTE1: If server is HANA DB and OS version is 6.7 DO NOT TAKE patching action.
NOTE2: If server is a vhana and requires snapshot or a phana requires a reboot, please contact Infra Team squad, as their team only has access at ESXI level(vhanas) and consol access (phanas) if servers are not coming up.

3. OS team reboots the servers
4. OS engineer to check the timezone on the server after the patching using the date command and, if needed, set it back to the timezone noted at point 2b 
5. SAP engineer to start all applications and DB running on the server as per Stop/Start procedure/doc


###################################################################


Hana upgrade from 6.5 to 6.7
0 people like this
 
Like
|Updated Feb 27 by Sagar Pandita|Tags: None Add tags
Edit
Page Actions

****Please check the time zone first , looks after the reboot the time zone is being changed ****

 
ls -lha /etc/localtime
date

[ibmbfernandez@BI1BWHDBDEV01 ~]$ ls -lha /etc/localtime
lrwxrwxrwx 1 root root 31 Jan 10  2017 /etc/localtime -> /usr/share/zoneinfo/Asia/Riyadh
[ibmbfernandez@BI1BWHDBDEV01 ~]$ date
Sat Sep  1 18:52:43 AST 2018



0. check date

 date

 

1. Disable zabbix from console

 

2. Take a VM snapshot (deselect memory snapshot)

 

3. Copy the iso from local Chef server to VM in /tmp folder
    scp /root/rhel-server-6.7-x86_64-dvd.iso x.x.x.x:/tmp

 

4. Login to VM and stop chef-client so it will not overwrite the yum settings during upgrade
    /etc/init.d/chef-client stop

 

5. Go to /etc/yum.repos.d/ and disable existing repos aod.repo, gold.repo and mercury.repo (edit and change to enabled=0)

    cd /etc/yum.repos.d

    sed -i 's/enabled=1/enabled=0/g' *

   If RH Satellite is applied, disable the subscriptions:
    subscription-manager repos --disable rhel-*

 

6. Mount the image
    mkdir /mnt/redhat
    mount -o loop /tmp/rhel-server-6.7-x86_64-dvd.iso /mnt/redhat
    cp /mnt/redhat/media.repo /etc/yum.repos.d/

 

7. Modify the new repo (/etc/yum.repos.d/media.repo). Add the following lines at the end
    baseurl=file:///mnt/redhat/Server
    gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release
    enabled=1

 

8. Clean and verify. Check if you see only InstallMedia and not Aod / Gold / Mercury or RH subscriptions (otherwise it will upgrade to 6.9 !)
    yum clean all
    yum repolist
    yum list

 

9. Update, check and confirm
    yum update

 

10. Modify vmxnet, othewise network interfaces might not come back
    vi /etc/modprobe.d/vmxnet3.conf (comment the line #options vmxnet3 disable_lro=1)

 

11. Finish and reboot
    umount /mnt/redhat
    rm -f /tmp/rhel-server-6.7-x86_64-dvd.iso
    reboot

 

12. Re-login and verify version:
    uname -a; cat /etc/redhat-release


    2.6.32-573.el6.x86_64 #1 SMP Wed Jul 1 18:23:37 EDT 2015 x86_64 x86_64 x86_64 GNU/Linux
    Red Hat Enterprise Linux Server release 6.7 (Santiago)

 

13. Run chef-client to re-configure yum repos
    chef-client

 

14. Reinstall vmware-tools as we have a new kernel AND double check for the correct version - 9.4.0.25793 (build-1280544). If you see a different version, please go to Vmware upgrade procedure and reinstall

(https://w3-connections.ibm.com/wikis/home?lang=en-us#!/wiki/W4bd546a87fc9_4881_b5c2_79a76bf49b1b/page/vHana%20-%20VMware%20Tools%20Removal%20Tracking)

(https://w3-connections.ibm.com/wikis/home?lang=en-us#!/wiki/W4bd546a87fc9_4881_b5c2_79a76bf49b1b/page/VMware%20tools%20manual%20upgrade%2C%20downgrade%2C%20uninstall%20(Linux%20CLI))

    vmware-config-tools.pl --default

    vmware-toolbox-cmd -v

 

15. Re-enable zabbix from console

 

16. Delete VM snapshot

 

17. (optional - needs confirmation) Update of compat-sap rpm. From local Chef server

   scp /root/compat-sap-c++-4.8.2-16.el6.x86_64.rpm x.x.x.x:/root

   rpm -Uvh compat-sap-c++-4.8.2-16.el6.x86_64.rpm

   ln -s -f /opt/rh/SAP/lib64/compat-sap-c++.so /usr/lib64/libstdc++.so.6



########################################################################

VMWARE TOOLS



VMware tools manual upgrade, downgrade, uninstall (Linux CLI)
0 people like this
 
Like
|Updated December 7, 2016 by Cristian Calin|Tags: None Add tags
Edit
Page Actions

 

Vmware tools version can be checked by running:


grep buildNr /usr/bin/vmware-config-tools.pl

or

vmware-toolbox-cmd -v

 

Vmware tools can be uninstalled with the command:


vmware-uninstall-tools.pl

 

To manually install Vmware tools, copy (scp from chef servers, root folder) the iso image into /tmp folder and follow the guideline:


 CORROBORAR DESPUES DE PARCHEAR LA VERSION DE VMWARE TOOLS:!@!!!!!!!!!!!!



Version 9.4.0-1280544 is used only on vHanas. This is the default versions that comes from SAP and is a stable one.


mkdir /mnt/vmware-tools
mount -o loop /tmp/VMware-tools-linux-9.4.0-1280544.iso /mnt/vmware-tools/
cp /mnt/vmware-tools/VMwareTools-9.4.0-1280544.tar.gz /tmp/
cd /tmp/
tar -xzvf VMwareTools-9.4.0-1280544.tar.gz
cd vmware-tools-distrib/
./vmware-install.pl --default

 

Version 10.0.9-3917699 is used on normal VMs (non Hana) running on vCenters

 

mkdir /mnt/vmware-tools
mount -o loop /tmp/VMware-tools-linux-10.0.9-3917699.iso /mnt/vmware-tools/
cp /mnt/vmware-tools/VMwareTools-10.0.9-3917699.tar.gz /tmp/
cd /tmp/
tar -xzvf VMwareTools-10.0.9-3917699.tar.gz
cd vmware-tools-distrib/
./vmware-install.pl --default

 

Check the service is running:


/etc/vmware-tools/services.sh status

 

Do a clean-up:



umount /mnt/vmware-tools/
rm -rf /tmp/vmware-tools-distrib/
rm -f /tmp/VMwareTools-9.4.0-1280544.tar.gz /tmp/VMware-tools-linux-9.4.0-1280544.iso

or:

rm -f /tmp/VMwareTools-10.0.9-3917699.tar.gz /tmp/VMware-tools-linux-10.0.9-3917699.iso

 

Sometimes, Vmware tools needs to be reinstalled (like a kernel upgrade or when the auto-update is not working for some reason), you can manually do this by running:

 

vmware-config-tools.pl --default


__________________________ TAMBIEN LOS PASOS PARA LOS QUE NO SON  vHANA________________________________


REDHAT CHANGE

OS Upgrade Procedure (Linux)
0 people like this
 
Like
|Updated Jun 11 by Jonathan Villalobos Arias|Tags: None Add tags
Edit
Page Actions

OS Upgrade Procedure.

 

Prerequisite:

 

Before doing OS upgrade it would be better to have some files back which can be used while doing troubleshooting when system is not coming back after applying upgrade.

 

Do a copy/paste of the following lines so we can have a full history file with different command results:

 

echo `date`;
echo -e "\n\nuname -a results\n";
uname -a;
echo -e "\n\nifconfig -a results\n";
ifconfig -a;
echo -e "\n\netc/hosts result\n";
cat /etc/hosts;
echo -e "\n\netc/fstab results\n";
cat /etc/fstab;
echo -e "\n\ndf -h results\n";
df -h;
echo -e "\n\netc/yum.conf results\n";
cat /etc/yum.conf;
echo -e "\n\netc/grub.conf results\n";
cat /etc/grub.conf;
echo -e "\n\netc/sysctl.conf results\n";
cat /etc/sysctl.conf;
echo -e "\n\nrpm results\n";
rpm -qa;
echo -e "\n\nyum history\n";
yum history;


Upgrade:


ls -lha /etc/localtime
date
 [ibmbfernandez@BI1BWHAPDEV01 ~]$ ls -lha /etc/localtime
lrwxrwxrwx 1 root root 31 Jan 10  2017 /etc/localtime -> /usr/share/zoneinfo/Asia/Riyadh
[ibmbfernandez@BI1BWHAPDEV01 ~]$ date
Sat Sep  1 17:13:59 AST 2018
[ibmbfernandez@BI1BWHAPDEV01 ~]$ hostname
BI1BWHAPDEV01
[ibmbfernandez@BI1BWHAPDEV01 ~]$ 

Clear Yum Cache:

 

yum clean all

 

Getting updates

 

yum check-update

 

Update the packages

 

yum update

 

Reboot server

 

shutdown -r now

 

Check red hat release and version after update:

 

cat /etc/redhat-release ; uname -a

 

In case of kernel upgrade, Vmware tools needs to be reinstalled by running (otherwise it will not start up with the VM):

 

vmware-config-tools.pl --default

 

PLEASE BE SURE TO CHECK TIMEZONE IS THE SAME AS BEFORE THE PATCH!!!!

 

PLEASE VALIDATE WITH SAP TEAM ALL MOUNTS AFTER REBOOTS

 

 

Rollback Plan:

 

In case, if we need to revert back do this:

 

Check yum history using “yum history”

 

ID | Login user | Date and time | Action(s) | Altered

This will give you such output, where you can determine ID, which has been applied as latest.

 

yum history undo <ID>

 

if you know there was a kernel upgrade ( for example from 6.7 to 6.9 )  a reboot is required!

 

Check red hat release and version after downgrade:

 

cat /etc/redhat-release ; uname -a

 
###########################################################################################


				QUE HACER EN MCO

los taps que se revisan son el uptime, y que root y ningun filesystems no este en RO = read only o sea que esten en writeable. Si / aparece como RO se debe pedir permiso a rebotear la maquina dado que esta en RO. Los Filesystems de sistema en RO se debe rebootear

vmwaretools running
agentsITM











############################################################################################
















